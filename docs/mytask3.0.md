# DAQ IDE MVP 开发任务列表（组件化核心版 v2.0）

**核心理念**：一切皆为组件 —— 用户通过拖拽组合组件，实现从数据采集、处理、存储到展示的全流程自定义。

**技术栈**：
- 后端引擎：Python（MVP）/ Golang（已有运行时可参考）
- 通信协议：MQTT（MVP 首选）
- 前端框架：阿里低代码引擎
- 图形编程：Blockly
- IDE 外壳：VSCode Extension

---

## 现有成果盘点（团队积累）

| 模块 | 负责人 | 技术方案 | 状态 |
|------|--------|----------|------|
| VSCode 插件 | 王阳明 | VSCode Extension API | ✅ 可复用 |
| UI 拖拽 | 王阳明 | 阿里低代码引擎（当前） | ✅ 可复用 |
| 大屏展示 | 张焕青 | - | ✅ 可复用 |
| 控件数据源绑定 | 王阳明 | - | ✅ 可复用 |
| 图形编程 | 白云 | Blockly → JS | ✅ 可复用 |
| 协议组件 | 杨晓凯 | OpenDAQ, MQTT, 61850 | ✅ 可复用 |
| 火龙果协议 | 王阳明 | - | ✅ 可复用 |
| AI 能力 | 白云 | MCP | ✅ 已跑通 |
| Golang 运行时 | 杨晓凯 | 设备交互 + Web 部署 | ✅ 可参考 |

**目前已能实现的功能**：
- ✅ 新建项目
- ✅ 拖拽组件（H5 低代码，大屏）
- ✅ 控件绑定数据源
- ✅ 简单脚本编写（Blockly → JS）
- ✅ 部署运行

---

## 阶段 0：现有成果整合与统一（核心工作）

**目标**：将分散的现有成果整合为统一的组件化架构

### 0.1 组件化标准制定
- [ ] 设计统一组件接口规范（Component Interface）
  - 组件类型枚举：Device / Logic / Storage / Display / Communication
  - 组件生命周期：init → configure → start → process → stop → destroy
  - 组件端口规范：输入端口、输出端口、数据类型
- [ ] 定义组件描述协议（Component Descriptor JSON Schema）
- [ ] 实现组件注册表机制

### 0.2 现有模块适配
- [ ] 将杨晓凯的协议组件（MQTT/OpenDAQ/61850）封装为标准组件
- [ ] 将王阳明的火龙果协议封装为标准组件
- [ ] 将张焕青的大屏控件封装为展示组件
- [ ] 将 Blockly 脚本封装为逻辑组件

### 0.3 项目文件统一
- [ ] 更新 .daq 项目 Schema 支持组件化描述
- [ ] 兼容现有项目格式迁移

---

## 阶段 1：Python 组件引擎（MVP 后端）

**目标**：实现 Python 版组件运行时，可与现有 Golang 运行时对接

### 1.1 引擎核心（新开发）
- [ ] 搭建组件化 Python 项目结构
- [ ] 实现 ComponentBase 基类
- [ ] 实现组件加载器 + 实例管理器
- [ ] 实现数据流调度器

### 1.2 设备组件
- [ ] MockDevice 组件 —— 模拟数据源（新开发）
- [x] MQTT 设备组件 —— 复用杨晓凯的 MQTT 实现
- [ ] OpenDAQ 组件 —— 复用杨晓凯的实现
- [ ] 61850 组件 —— 复用杨晓凯的实现
- [ ] 火龙果组件 —— 复用王阳明的实现

### 1.3 逻辑组件（新开发 + 复用 Blockly）
- [ ] 数学运算组件
- [ ] 条件判断组件
- [x] Blockly 脚本组件 —— 复用白云的 Blockly → JS

### 1.4 存储组件（新开发）
- [ ] CSV 文件存储组件
- [ ] JSON 文件存储组件
- [ ] 时序数据库组件（可选）

---

## 阶段 2：VSCode 扩展增强

**基础**：复用王阳明的 VSCode 插件

- [ ] 集成组件化项目管理
- [ ] 添加组件库浏览器面板
- [ ] 集成 Python 引擎启动/停止
- [ ] 输出面板增强（日志分级）

---

## 阶段 3：可视化组件编排器

**基础**：复用王阳明的阿里低代码引擎

### 3.1 组件库集成
- [ ] 将后端组件（设备/逻辑/存储）注册到低代码组件库
- [ ] 实现组件分类导航（设备/逻辑/存储/展示）
- [ ] 实现组件搜索

### 3.2 连线系统（可能需要新开发或增强）
- [ ] 组件间数据流连线
- [ ] 端口类型兼容性检查
- [ ] 数据流可视化

### 3.3 配置面板
- [ ] 组件属性配置（复用低代码 setter 机制）
- [ ] 配置变更实时同步

---

## 阶段 4：展示层增强

**基础**：复用张焕青的大屏 + 王阳明的数据源绑定

- [ ] 将大屏控件封装为标准展示组件
- [ ] 增强数据源绑定（支持 MQTT 实时推送）
- [ ] 仪表盘布局保存/加载

---

## 阶段 5：集成与验证

**目标**：端到端全流程打通

- [ ] 黄金样例测试：MQTT 设备 → 逻辑处理 → 存储 → 大屏展示
- [ ] 与现有 Golang 运行时对接测试
- [ ] Blockly 脚本执行集成测试
- [ ] 10 分钟上手目标验证

---

## 阶段 6：AI 助手

**基础**：复用白云的 MCP 实现

- [ ] 集成到 VSCode 侧边栏
- [ ] 组件推荐功能
- [ ] 配置解释/生成功能

---

## 组件类型总览

| 类型 | 组件示例 | 来源 |
|------|----------|------|
| **Device** | MockDevice | 新开发 |
| **Communication** | MQTT, OpenDAQ, 61850, 火龙果 | 复用（杨晓凯/王阳明） |
| **Logic** | Math, Compare, BlocklyScript | 新开发 + 复用（白云） |
| **Storage** | CSV, JSON, InfluxDB | 新开发 |
| **Display** | Chart, Gauge, LED, 大屏控件 | 复用（张焕青） |

---

## MVP 工作量评估

| 类别 | 工作项 | 预估 |
|------|--------|------|
| **复用整合** | 现有成果封装为标准组件 | 中等 |
| **新开发** | Python 组件引擎核心 | 较大 |
| **新开发** | 存储组件 | 较小 |
| **增强** | 连线系统 | 中等 |
| **测试** | 端到端集成 | 中等 |

**核心工作**：阶段 0（标准制定 + 整合）+ 阶段 1（Python 引擎）

---

## 团队分工建议

| 成员 | 职责 |
|------|------|
| 杨晓凯 | 协议组件标准化封装 + Python 引擎对接 |
| 王阳明 | VSCode 插件增强 + 低代码连线系统 + 火龙果封装 |
| 张焕青 | 大屏控件组件化封装 |
| 白云 | Blockly 逻辑组件封装 + AI 助手集成 |
| 架构师 | 组件接口规范制定 + 整体集成 |